# ~/.login_autostart: start programs on every login

### start ssh agent
SSH_AGENT_ENV_FILE=$HOME/.ssh/ssh-agent-info
start_ssh_agent() {
	ssh-agent -s > $SSH_AGENT_ENV_FILE
	. "$SSH_AGENT_ENV_FILE" > /dev/null
}

if [ -f "$SSH_AGENT_ENV_FILE" ]; then
	. "$SSH_AGENT_ENV_FILE" > /dev/null
	# file may be old, try connecting
	if [ -z "$(ps aux|grep $USER|grep $SSH_AGENT_PID|grep ssh-agent)" ]; then
		# daemon does not exist with this pid, start new one
		start_ssh_agent
	fi
else
	# no agent env file yet
	start_ssh_agent
fi

### start mpd and mpdscribble
[ -x /usr/bin/mpd -a -r ~/.mpd/mpd.conf ] && \
	start-stop-daemon --quiet --start --user $USER --pidfile ~/.mpd/pid \
	--oknodo --startas /usr/bin/mpd -- ~/.mpd/mpd.conf
